use tappli aggreg along custom function aggreg id cid data dt fun function x c mn mean x ln length x may like see blog discuss scenario http r4sqlmind blogspot com 2015 06 select data data frame html