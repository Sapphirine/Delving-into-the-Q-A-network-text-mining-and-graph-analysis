first let tell m spark expert ve use quit lot last month believ understand may wrong answer question equival way re see spark optim graph wonder custommapp still execut twice case due fact spark rdd1 rdd2 two complet differ rdd build transform graph bottom start leaf option 1 translat rdd0 rddin map lambda x custommapp x filter lambda x x 0 0 cach rdd1 rddin map lambda x custommapp x filter lambda x x 0 1 cach said custommapp execut twice moreov also rddin read twice mean come databas may even slower b way move cach right place mappedrdd rddin map lambda x custommapp x cach rdd0 mappedrdd filter lambda x x 0 0 rdd1 mappedrdd filter lambda x x 0 1 tell spark store partial result mappedrdd use partial result rdd1 rdd2 spark point view equival mappedrdd rddin map lambda x custommapp x saveasobjectfil forget everythingrdd0 sc objectfil filter lambda x x 0 0 rdd1 sc objectfil filter lambda x x 0 1