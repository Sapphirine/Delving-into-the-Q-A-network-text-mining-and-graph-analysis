adapt pete answer implement solut demonstr ! usr bin env python3import randomimport pandasimport timeimport datetimedef getrandomd n tsmin time mktime time strptime 1980 01 01 00 00 00 y m d h m tsmax time mktime time strptime 2005 12 31 23 59 59 y m d h m return panda seri datetim datetim fromtimestamp tsmin random random tsmax tsmin x rang 0 n def setmaxyear tss target maxyearbefor tss max datetim year timedelta cannot given year comput number day add next line deltaday datetim date target 1 1 datetim date maxyearbefor 1 1 day return tss panda timedelta day deltaday data panda datafram t1 getrandomd 1000 data t2 setmaxyear data t1 2015 data delta data t2 data t1 print data print delta min str min data delta print delta max str max data delta