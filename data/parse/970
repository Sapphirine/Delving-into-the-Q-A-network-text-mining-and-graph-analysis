use reshape2 packag task first transform data long format melt librari reshape2 dat m melt dat measur var c fruit amt veg amt dat name data frame second cast wide format dcast dat m id timefram variabl date result id fruit amt 04 16 2014 fruit amt 05 23 2013 fruit amt 05 24 2014 veg amt 04 16 20141 4352 0 0 06 na 02 5002 na na 0 06 na veg amt 05 23 2013 veg amt 05 24 2014 fruit amt 05 23 2013 fruit amt 05 24 20141 0 25 na 0 25 na2 na 0 25 na 0 75 veg amt 05 23 2013 veg amt 05 24 20141 0 75 na2 na 0 25